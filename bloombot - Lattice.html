<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lattice — bloombot</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    :root{
      --ink:#1a1612;--cream:#f5f0e8;--warm:#e8dcc8;
      --rust:#c4541a;--amber:#d97706;--forest:#2d5a27;
      --slate:#64748b;--border:#d1c4aa;--shadow:rgba(26,22,18,0.10);
      --c341:#b45309;
    }
    html{scroll-behavior:smooth;}
    body{font-family:'Space Grotesk',sans-serif;background:var(--cream);color:var(--ink);line-height:1.6;}

    /* ── NAV ── */
    nav{position:sticky;top:0;z-index:100;background:var(--ink);display:flex;align-items:center;justify-content:space-between;padding:0 2rem;height:56px;border-bottom:3px solid var(--rust);}
    .nav-brand{font-family:'Space Mono',monospace;font-size:1.2rem;font-weight:700;color:var(--amber);text-decoration:none;letter-spacing:-0.03em;}
    .nav-links{display:flex;list-style:none;overflow:visible;}
    .nav-links li{position:relative;}
    .nav-links li>a{display:flex;align-items:center;gap:0.3rem;height:56px;padding:0 0.9rem;color:rgba(255,255,255,0.65);text-decoration:none;font-size:0.78rem;font-weight:500;letter-spacing:0.04em;text-transform:uppercase;white-space:nowrap;transition:color 0.2s,background 0.2s;}
    .nav-links li>a:hover{color:#fff;background:rgba(255,255,255,0.07);}
    .nav-links li>a.active{color:var(--amber);}
    .caret{font-size:0.55rem;opacity:0.5;}
    .dropdown{display:none;position:absolute;top:56px;left:0;background:#111;border:1px solid rgba(255,255,255,0.1);border-top:2px solid var(--rust);border-radius:0 0 8px 8px;min-width:200px;list-style:none;z-index:200;box-shadow:0 8px 24px rgba(0,0,0,0.4);}
    .nav-links li:hover .dropdown{display:block;}
    .dropdown li a{display:block;padding:0.6rem 1rem;font-size:0.78rem;color:rgba(255,255,255,0.65);border-bottom:1px solid rgba(255,255,255,0.06);white-space:nowrap;text-decoration:none;}
    .dropdown li:last-child a{border-bottom:none;}
    .dropdown li a:hover{color:#fff;background:rgba(255,255,255,0.07);}

    /* ── HERO ── */
    .page-hero{background:var(--c341);color:#fff;padding:3.5rem 2rem 3rem;position:relative;overflow:hidden;}
    .page-hero::before{content:'';position:absolute;inset:0;pointer-events:none;background:repeating-linear-gradient(0deg,transparent,transparent 39px,rgba(255,255,255,0.04) 39px,rgba(255,255,255,0.04) 40px),repeating-linear-gradient(90deg,transparent,transparent 39px,rgba(255,255,255,0.04) 39px,rgba(255,255,255,0.04) 40px);}
    .page-hero-inner{max-width:1100px;margin:0 auto;position:relative;}
    .breadcrumb{font-family:'Space Mono',monospace;font-size:0.7rem;letter-spacing:0.14em;text-transform:uppercase;color:rgba(255,255,255,0.5);margin-bottom:0.75rem;}
    .breadcrumb a{color:rgba(255,255,255,0.4);text-decoration:none;}
    .breadcrumb a:hover{color:rgba(255,255,255,0.8);}
    .page-title{font-size:clamp(2rem,5vw,3.5rem);font-weight:700;letter-spacing:-0.04em;line-height:1.05;margin-bottom:0.75rem;}
    .page-desc{font-size:1rem;color:rgba(255,255,255,0.7);max-width:620px;line-height:1.75;}

    /* ── LAYOUT ── */
    .section{max-width:1100px;margin:0 auto;padding:3rem 2rem;}
    .section-label{font-family:'Space Mono',monospace;font-size:0.68rem;letter-spacing:0.2em;text-transform:uppercase;color:var(--slate);margin-bottom:1.25rem;display:flex;align-items:center;gap:0.5rem;}
    .section-label::after{content:'';flex:1;height:1px;background:var(--border);max-width:60px;}

    .context-note{background:#fff;border:1.5px solid var(--border);border-left:4px solid var(--c341);border-radius:8px;padding:1.25rem 1.5rem;max-width:820px;margin-bottom:2.5rem;}
    .context-note p{font-size:0.92rem;color:var(--ink);line-height:1.75;}

    /* ── GENERATOR ── */
    .generator{display:grid;grid-template-columns:260px 1fr;gap:2rem;align-items:start;}

    /* ── CONTROLS ── */
    .controls-panel{background:#fff;border:1.5px solid var(--border);border-radius:12px;padding:1.5rem;position:sticky;top:72px;}
    .ctrl-section-head{font-family:'Space Mono',monospace;font-size:0.68rem;letter-spacing:0.14em;text-transform:uppercase;color:var(--c341);font-weight:700;margin:1.25rem 0 0.75rem;padding-top:1rem;border-top:1px solid var(--border);}
    .ctrl-section-head:first-child{margin-top:0;padding-top:0;border-top:none;}
    .ctrl-group{margin-bottom:1rem;}
    .ctrl-group label{display:block;font-size:0.78rem;font-weight:600;color:var(--ink);margin-bottom:0.3rem;}
    .ctrl-group input[type="number"]{width:100%;padding:0.45rem 0.6rem;border:1.5px solid var(--border);border-radius:6px;font-family:'Space Grotesk',sans-serif;font-size:0.85rem;color:var(--ink);background:var(--cream);transition:border-color 0.15s;}
    .ctrl-group input[type="number"]:focus{outline:none;border-color:var(--c341);}
    .ctrl-hint{font-family:'Space Mono',monospace;font-size:0.65rem;color:var(--slate);margin-top:0.2rem;}

    .preset-bar{display:flex;align-items:center;gap:0.4rem;flex-wrap:wrap;padding:0.75rem 0 0.1rem;border-top:1px solid var(--border);margin-top:0.75rem;}
    .preset-label{font-family:'Space Mono',monospace;font-size:0.62rem;letter-spacing:0.12em;text-transform:uppercase;color:var(--slate);margin-right:0.2rem;white-space:nowrap;}
    .preset-btn{padding:0.3rem 0.7rem;border:1.5px solid var(--border);border-radius:20px;background:var(--cream);color:var(--ink);font-family:'Space Grotesk',sans-serif;font-size:0.75rem;font-weight:500;cursor:pointer;transition:all 0.15s;white-space:nowrap;}
    .preset-btn:hover{border-color:var(--c341);color:var(--c341);}
    .preset-btn.active{background:var(--c341);border-color:var(--c341);color:#fff;font-weight:600;}

    .btn-group{display:flex;flex-direction:column;gap:0.6rem;margin-top:1.5rem;padding-top:1rem;border-top:1px solid var(--border);}
    .action-btn{border:none;padding:0.6rem 1rem;border-radius:6px;font-family:'Space Grotesk',sans-serif;font-size:0.8rem;font-weight:600;cursor:pointer;letter-spacing:0.02em;transition:background 0.15s;}
    .action-btn.primary{background:var(--c341);color:#fff;}
    .action-btn.primary:hover{background:var(--rust);}
    .action-btn.secondary{background:var(--warm);color:var(--ink);border:1.5px solid var(--border);}
    .action-btn.secondary:hover{background:var(--border);}

    /* ── CANVAS OUTPUT ── */
    .output-panel{background:#fff;border:1.5px solid var(--border);border-radius:12px;padding:1.25rem;overflow:hidden;}
    .canvas-wrap{width:100%;overflow-x:auto;}
    #canvas{display:block;border-radius:6px;background:#fff;max-width:100%;}
    .canvas-hint{font-family:'Space Mono',monospace;font-size:0.65rem;color:var(--slate);margin-top:0.75rem;}

    /* ── FOOTER ── */
    footer{background:var(--ink);color:rgba(255,255,255,0.4);text-align:center;padding:2.5rem 2rem;font-family:'Space Mono',monospace;font-size:0.72rem;letter-spacing:0.06em;line-height:2;margin-top:4rem;}
    footer a{color:var(--amber);text-decoration:none;}

    @media(max-width:780px){.generator{grid-template-columns:1fr;}.controls-panel{position:static;}.nav-links{display:none;}}
  </style>
</head>
<body>

<nav>
  <a class="nav-brand" href="bloombot-modern.html">bloombot</a>
  <ul class="nav-links">
    <li>
      <a href="bloombot-i101.html">I 101 <span class="caret">▼</span></a>
      <ul class="dropdown">
        <li><a href="bloombot-i101.html#networks">Networks</a></li>
        <li><a href="bloombot-i101.html#ethics">Ethics</a></li>
        <li><a href="bloombot-i101.html#security">Security</a></li>
        <li><a href="bloombot-i101.html#diversity">Diversity</a></li>
        <li><a href="bloombot-i101.html#design">Design</a></li>
        <li><a href="bloombot-i101.html#data">Data</a></li>
      </ul>
    </li>
    <li>
      <a href="bloombot-stories.html">Stories <span class="caret">▼</span></a>
      <ul class="dropdown">
        <li><a href="bloombot - Lightning.html">Lightning</a></li>
        <li><a href="bloombot - Coffee.html">Coffee</a></li>
      </ul>
    </li>
    <li>
      <a href="bloombot-prototyping.html" class="active">Prototyping <span class="caret">▼</span></a>
      <ul class="dropdown">
        <li><a href="bloombot - 3D Graph Paper.html">3D Graph Paper</a></li>
        <li><a href="bloombot - Lattice.html">Lattice</a></li>
        <li><a href="bloombot - Encoder Wheel.html">Encoder Wheel</a></li>
        <li><a href="webpage-main/stlM2.html">3D Model Viewer</a></li>
      </ul>
    </li>
    <li><a href="bloombot-scaffolds.html">Scaffolds</a></li>
  </ul>
</nav>

<header class="page-hero">
  <div class="page-hero-inner">
    <p class="breadcrumb"><a href="bloombot-modern.html">bloombot</a> / <a href="bloombot-prototyping.html">Prototyping</a> / Lattice</p>
    <h1 class="page-title">Lattice</h1>
    <p class="page-desc">A random lattice pattern generator for digital fabrication — cut from paper, fabric, wood, or plastic. Tune the density, scale, and variation, then export as SVG.</p>
  </div>
</header>

<div class="section">

  <div class="context-note">
    <p>Generate a vector pattern for use in digital fabrication machines — laser cutters, vinyl cutters, CNC routers. Packed rectangles with controlled spacing and size variation produce lattice structures suitable for cutting in paper or fabric sheets, or panels of wood, plastic, and so on.</p>
  </div>

  <p class="section-label">Generator</p>

  <div class="generator">

    <!-- CONTROLS -->
    <div class="controls-panel">

      <div class="ctrl-section-head" style="margin-top:0;padding-top:0;border-top:none;">Rectangle Size</div>

      <div class="ctrl-group">
        <label for="width">Width</label>
        <input type="number" id="width" value="10" min="1" max="200">
        <div class="ctrl-hint">base width in pixels</div>
      </div>
      <div class="ctrl-group">
        <label for="height">Height</label>
        <input type="number" id="height" value="10" min="1" max="200">
        <div class="ctrl-hint">base height in pixels</div>
      </div>

      <div class="ctrl-section-head">Layout</div>

      <div class="ctrl-group">
        <label for="spacing">Spacing</label>
        <input type="number" id="spacing" value="2" min="0" max="50">
        <div class="ctrl-hint">gap between rectangles</div>
      </div>
      <div class="ctrl-group">
        <label for="variation">Variation %</label>
        <input type="number" id="variation" value="10" min="0" max="100">
        <div class="ctrl-hint">size and spacing randomness</div>
      </div>
      <div class="ctrl-group">
        <label for="count">Number of Rectangles</label>
        <input type="number" id="count" value="1000" min="1" max="5000">
        <div class="ctrl-hint">more = denser fill, slower</div>
      </div>

      <div class="btn-group">
        <button class="action-btn primary" onclick="drawRectangles()">Generate Pattern</button>
        <button class="action-btn secondary" onclick="downloadAsSVG()">Download as SVG</button>
      </div>
    </div>

    <!-- OUTPUT -->
    <div class="output-panel">
      <div class="canvas-wrap">
        <canvas id="canvas" width="800" height="500"></canvas>
      </div>
      <div class="preset-bar" id="presetGrid">
        <span class="preset-label">Presets</span>
        <button class="preset-btn" data-idx="0" onclick="applyPreset(0)">Standard</button>
        <button class="preset-btn" data-idx="1" onclick="applyPreset(1)">Scatter</button>
        <button class="preset-btn" data-idx="2" onclick="applyPreset(2)">Reeds</button>
        <button class="preset-btn" data-idx="3" onclick="applyPreset(3)">Grain</button>
        <button class="preset-btn" data-idx="4" onclick="applyPreset(4)">Slats</button>
        <button class="preset-btn" data-idx="5" onclick="applyPreset(5)">Windows</button>
      </div>
    </div>

  </div>
</div>

<footer>
  <div>bloombot &nbsp;·&nbsp; Matthew Francisco &nbsp;·&nbsp; Luddy School of Informatics, Computing &amp; Engineering</div>
  <div>Indiana University &nbsp;·&nbsp; <a href="bloombot-modern.html">Home</a></div>
</footer>

<script>
  // ── Presets ──
  const PRESETS = [
    { name: 'Standard', width: 10, height: 10, spacing: 2, variation: 10,  count: 1000 },
    { name: 'Scatter',  width: 27, height: 27, spacing: 2, variation: 40,  count: 115  },
    { name: 'Reeds',    width: 15, height: 3,  spacing: 2, variation: 25,  count: 4400 },
    { name: 'Grain',    width: 4,  height: 4,  spacing: 1, variation: 30,  count: 3500 },
    { name: 'Slats',    width: 3,  height: 25, spacing: 2, variation: 60,  count: 1400 },
    { name: 'Windows',  width: 50, height: 40, spacing: 2, variation: 20,  count: 80   },
  ];

  function applyPreset(idx) {
    const p = PRESETS[idx];
    document.getElementById('width').value     = p.width;
    document.getElementById('height').value    = p.height;
    document.getElementById('spacing').value   = p.spacing;
    document.getElementById('variation').value = p.variation;
    document.getElementById('count').value     = p.count;
    document.querySelectorAll('.preset-btn').forEach((btn, i) => {
      btn.classList.toggle('active', i === idx);
    });
    drawRectangles();
  }

  function getRandomInt(max) { return Math.floor(Math.random() * max); }
  function paintBlack() { return '#b45309'; }

  function getRandomColor() {
    const letters = '0123456789ABCDEF';
    let color = '#';
    for (let i = 0; i < 6; i++) color += letters[Math.floor(Math.random() * 16)];
    return color;
  }

  function rectanglesOverlap(rect1, rect2) {
    return !(rect1.x + rect1.width + rect1.spacing < rect2.x ||
             rect1.x > rect2.x + rect2.width + rect2.spacing ||
             rect1.y + rect1.height + rect1.spacing < rect2.y ||
             rect1.y > rect2.y + rect2.height + rect2.spacing);
  }

  let rectangles = [];

  function drawRectangles() {
    const baseWidth   = parseInt(document.getElementById('width').value);
    const baseHeight  = parseInt(document.getElementById('height').value);
    const baseSpacing = parseInt(document.getElementById('spacing').value);
    const baseVar     = parseInt(document.getElementById('variation').value);
    const count       = parseInt(document.getElementById('count').value);

    if (isNaN(baseWidth) || isNaN(baseHeight) || isNaN(count) || count <= 0) {
      alert('Please enter valid numbers for width, height, and count.');
      return;
    }

    const canvas  = document.getElementById('canvas');
    const context = canvas.getContext('2d');
    context.clearRect(0, 0, canvas.width, canvas.height);
    context.fillStyle = '#f5f0e8';
    context.fillRect(0, 0, canvas.width, canvas.height);

    const minSpacing = baseSpacing;
    rectangles = [];

    for (let i = 0; i < count; i++) {
      let widthVariation, heightVariation, x, y;
      let attempts = 100;
      do {
        let w = baseWidth  * (getRandomInt(baseVar + 1) / 100) + 1;
        widthVariation  = baseWidth  + w;
        heightVariation = baseHeight + w;
        x = getRandomInt(canvas.width  - widthVariation);
        y = getRandomInt(canvas.height - heightVariation);
        var newRect = { x, y, width: widthVariation, height: heightVariation, spacing: minSpacing, color: paintBlack() };
        attempts--;
      } while (rectangles.some(rect => rectanglesOverlap(rect, newRect)) && attempts > 0);

      if (attempts > 0) {
        rectangles.push(newRect);
        context.fillStyle = newRect.color;
        context.fillRect(x, y, widthVariation, heightVariation);
      }
    }
  }

  function downloadAsSVG() {
    const canvas = document.getElementById('canvas');
    const svgParts = [`<svg xmlns="http://www.w3.org/2000/svg" width="${canvas.width}" height="${canvas.height}">`];
    rectangles.forEach(rect => {
      svgParts.push(`<rect x="${rect.x}" y="${rect.y}" width="${rect.width}" height="${rect.height}" fill="${rect.color}" />`);
    });
    svgParts.push('</svg>');
    const a = Object.assign(document.createElement('a'), {
      href: URL.createObjectURL(new Blob([svgParts.join('')], {type: 'image/svg+xml;charset=utf-8'})),
      download: 'lattice.svg'
    });
    document.body.appendChild(a); a.click(); document.body.removeChild(a);
  }

  // Load a random preset on arrival
  applyPreset(Math.floor(Math.random() * PRESETS.length));
</script>
</body>
</html>
